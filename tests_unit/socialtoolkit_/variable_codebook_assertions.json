{
  "test_when_add_variable_is_executed_then_success_status_is_returned": ["assert result['success'] is True", "f\"Expected result['success'] to be True, but got {result['success']}\""],
  "test_when_add_variable_is_executed_then_variable_is_added_to_variables_dictionary": ["assert 'new_var' in variable_codebook_fixture.variables", "f\"Expected 'new_var' to be in variables, but got {list(variable_codebook_fixture.variables.keys())}\""],
  "test_when_add_variable_is_executed_then_variable_is_persisted_to_storage": ["assert storage_service.save.called", "f\"Expected storage_service.save to be called, but called={storage_service.save.called}\""],
  "test_when_adding_duplicate_variable_then_error_indicates_duplicate": ["assert 'duplicate' in result['error'].lower()", "f\"Expected 'duplicate' in error message, but got {result['error']}\""],
  "test_when_adding_duplicate_variable_then_error_is_raised_or_returned": ["assert 'error' in result", "f\"Expected 'error' key in result, but got {list(result.keys())}\""],
  "test_when_assumptions_are_retrieved_then_may_contain_business_field": ["assert isinstance(assumptions.business, BusinessAssumptions)", "f\"Expected assumptions.business to be BusinessAssumptions, but got {type(assumptions.business)}\""],
  "test_when_assumptions_are_retrieved_then_may_contain_business_owner_field": ["assert isinstance(assumptions.business_owner, BusinessOwnerAssumptions)", "f\"Expected assumptions.business_owner to be BusinessOwnerAssumptions, but got {type(assumptions.business_owner)}\""],
  "test_when_assumptions_are_retrieved_then_may_contain_general_assumptions_list": ["assert isinstance(assumptions.general_assumptions, list)", "f\"Expected assumptions.general_assumptions to be list, but got {type(assumptions.general_assumptions)}\""],
  "test_when_assumptions_are_retrieved_then_may_contain_specific_assumptions_dictionary": ["assert isinstance(assumptions.specific_assumptions, dict)", "f\"Expected assumptions.specific_assumptions to be dict, but got {type(assumptions.specific_assumptions)}\""],
  "test_when_assumptions_are_retrieved_then_may_contain_taxes_field": ["assert isinstance(assumptions.taxes, TaxesAssumptions)", "f\"Expected assumptions.taxes to be TaxesAssumptions, but got {type(assumptions.taxes)}\""],
  "test_when_business_assumptions_exist_then_contains_expected_fields": ["assert hasattr(assumptions.business, 'year_of_operation')", "f\"Expected assumptions.business to have 'year_of_operation' attribute, but attributes are {dir(assumptions.business)}\""],
  "test_when_business_owner_assumptions_exist_then_contains_has_annual_gross_income": ["assert hasattr(assumptions.business_owner, 'has_annual_gross_income')", "f\"Expected assumptions.business_owner to have 'has_annual_gross_income' attribute, but attributes are {dir(assumptions.business_owner)}\""],
  "test_when_cache_is_disabled_then_cache_is_not_checked": ["assert not cache_service.get.called", "f\"Expected cache_service.get.called to be False, but got {cache_service.get.called}\""],
  "test_when_cache_is_disabled_then_variable_is_always_retrieved_from_storage": ["assert storage_service.get.called", "f\"Expected storage_service.get.called to be True, but got {storage_service.get.called}\""],
  "test_when_cache_is_enabled_and_variable_cached_then_cache_ttl_is_set": ["assert cache_service.set.call_args[1]['ttl'] == variable_codebook_fixture.configs.cache_ttl_seconds", "f\"Expected cache TTL to be {variable_codebook_fixture.configs.cache_ttl_seconds}, but got {cache_service.set.call_args[1]['ttl']}\""],
  "test_when_cache_is_enabled_and_variable_in_cache_then_storage_service_is_not_queried": ["assert not storage_service.get.called", "f\"Expected storage_service.get.called to be False, but got {storage_service.get.called}\""],
  "test_when_cache_is_enabled_and_variable_in_cache_then_variable_is_returned_from_cache": ["assert result['variable'] == cached_variable", "f\"Expected result['variable'] to be {cached_variable}, but got {result['variable']}\""],
  "test_when_cache_is_enabled_and_variable_not_in_cache_then_variable_is_added_to_cache": ["assert cache_service.set.called", "f\"Expected cache_service.set.called to be True, but got {cache_service.set.called}\""],
  "test_when_calling_run_with_add_variable_action_then_success_status_is_returned": ["assert result['success'] is True", "f\"Expected result['success'] to be True, but got {result['success']}\""],
  "test_when_calling_run_with_add_variable_action_then_variable_is_added": ["assert new_variable.item_name in variable_codebook_fixture.variables", "f\"Expected {new_variable.item_name} to be in variables, but got {list(variable_codebook_fixture.variables.keys())}\""],
  "test_when_calling_run_with_get_assumptions_action_then_assumptions_are_retrieved": ["assert 'assumptions' in result", "f\"Expected 'assumptions' key in result, but got {list(result.keys())}\""],
  "test_when_calling_run_with_get_prompt_sequence_action_then_list_of_prompts_is_returned": ["assert isinstance(result['prompt_sequence'], list)", "f\"Expected result['prompt_sequence'] to be list, but got {type(result['prompt_sequence'])}\""],
  "test_when_calling_run_with_get_prompt_sequence_action_then_prompt_sequence_is_retrieved": ["assert result['success'] is True", "f\"Expected result['success'] to be True, but got {result['success']}\""],
  "test_when_calling_run_with_get_variable_action_then_dictionary_with_variable_is_returned": ["assert isinstance(result, dict)", "f\"Expected result to be dict, but got {type(result)}\""],
  "test_when_calling_run_with_get_variable_action_then_variable_is_retrieved": ["assert result['success'] is True", "f\"Expected result['success'] to be True, but got {result['success']}\""],
  "test_when_calling_run_with_unknown_action_then_error_message_indicates_unknown_action": ["assert 'unknown action' in str(error).lower()", "f\"Expected 'unknown action' in error message, but got {str(error)}\""],
  "test_when_calling_run_with_unknown_action_then_value_error_is_raised": ["assert isinstance(error, ValueError)", "f\"Expected error to be ValueError, but got {type(error)}\""],
  "test_when_calling_run_with_update_variable_action_then_success_status_is_returned": ["assert result['success'] is True", "f\"Expected result['success'] to be True, but got {result['success']}\""],
  "test_when_calling_run_with_update_variable_action_then_variable_is_updated": ["assert variable_codebook_fixture.variables['income_tax'] == updated_variable", "f\"Expected variables['income_tax'] to be {updated_variable}, but got {variable_codebook_fixture.variables['income_tax']}\""],
  "test_when_decision_tree_is_accessed_then_it_contains_nodes_and_edges": ["assert len(decision_tree.nodes) > 0", "f\"Expected decision_tree.nodes length to be > 0, but got {len(decision_tree.nodes)}\""],
  "test_when_decision_tree_is_accessed_then_it_is_nx_digraph_object": ["assert isinstance(decision_tree, nx.DiGraph)", "f\"Expected decision_tree to be nx.DiGraph, but got {type(decision_tree)}\""],
  "test_when_decision_tree_is_missing_then_warning_is_logged": ["assert any('No prompt decision tree found' in str(record.message) for record in caplog.records)", "f\"Expected 'No prompt decision tree found' in logs, but got {[str(r.message) for r in caplog.records]}\""],
  "test_when_default_assumptions_disabled_then_no_default_assumptions_are_added": ["assert variable.assumptions is None", "f\"Expected variable.assumptions to be None, but got {variable.assumptions}\""],
  "test_when_default_assumptions_disabled_then_variable_retains_original_assumptions": ["assert variable.assumptions == original_assumptions", "f\"Expected variable.assumptions to be {original_assumptions}, but got {variable.assumptions}\""],
  "test_when_default_assumptions_enabled_then_assumptions_include_default_values": ["assert variable.assumptions is not None", "f\"Expected variable.assumptions to not be None, but got {variable.assumptions}\""],
  "test_when_default_assumptions_enabled_then_default_business_assumptions_are_applied": ["assert variable.assumptions.business is not None", "f\"Expected variable.assumptions.business to not be None, but got {variable.assumptions.business}\""],
  "test_when_dict_is_deserialized_then_decision_tree_is_restored_as_digraph": ["assert isinstance(deserialized_variable.prompt_decision_tree._graph, nx.DiGraph)", "f\"Expected deserialized decision tree to be nx.DiGraph, but got {type(deserialized_variable.prompt_decision_tree._graph)}\""],
  "test_when_get_prompt_sequence_is_called_then_exactly_n_prompts_are_returned": ["assert len(prompts) == 3", "f\"Expected 3 prompts, but got {len(prompts)}\""],
  "test_when_get_prompt_sequence_is_called_then_prompts_are_in_tree_traversal_order": ["assert prompts == expected_order", "f\"Expected prompts to be {expected_order}, but got {prompts}\""],
  "test_when_get_variable_fails_then_error_indicates_variable_not_found": ["assert 'variable not found' in result['error'].lower()", "f\"Expected 'variable not found' in error message, but got {result['error']}\""],
  "test_when_get_variable_fails_then_result_contains_error_key": ["assert 'error' in result", "f\"Expected 'error' key in result, but got {list(result.keys())}\""],
  "test_when_get_variable_fails_then_result_contains_success_false": ["assert result['success'] is False", "f\"Expected result['success'] to be False, but got {result['success']}\""],
  "test_when_get_variable_succeeds_then_result_contains_success_true": ["assert result['success'] is True", "f\"Expected result['success'] to be True, but got {result['success']}\""],
  "test_when_get_variable_succeeds_then_result_contains_variable_key": ["assert 'variable' in result", "f\"Expected 'variable' key in result, but got {list(result.keys())}\""],
  "test_when_get_variable_succeeds_then_variable_is_variable_object": ["assert isinstance(result['variable'], Variable)", "f\"Expected result['variable'] to be Variable, but got {type(result['variable'])}\""],
  "test_when_input_has_no_matching_keywords_then_default_variable_is_used": ["assert variable_name == 'generic_tax_information'", "f\"Expected variable_name to be 'generic_tax_information', but got {variable_name}\""],
  "test_when_input_is_about_property_tax_then_prompts_for_property_tax_are_returned": ["assert len(prompts) > 0", "f\"Expected prompts length to be > 0, but got {len(prompts)}\""],
  "test_when_input_is_about_property_tax_then_variable_name_is_extracted": ["assert variable_name == 'property_tax'", "f\"Expected variable_name to be 'property_tax', but got {variable_name}\""],
  "test_when_input_is_about_sales_tax_then_prompts_for_sales_tax_city_are_returned": ["assert len(prompts) > 0", "f\"Expected prompts length to be > 0, but got {len(prompts)}\""],
  "test_when_input_is_about_sales_tax_then_variable_name_is_extracted": ["assert variable_name == 'sales_tax_city'", "f\"Expected variable_name to be 'sales_tax_city', but got {variable_name}\""],
  "test_when_keyword_is_in_input_then_correct_variable_name_is_extracted": ["assert variable_name == expected_variable_name", "f\"Expected variable_name to be {expected_variable_name}, but got {variable_name}\""],
  "test_when_load_from_file_is_false_then_no_file_loading_occurs": ["assert not file_read_called", "f\"Expected file_read_called to be False, but got {file_read_called}\""],
  "test_when_load_from_file_is_false_then_self_variables_starts_empty": ["assert len(variable_codebook_fixture.variables) == 0", "f\"Expected variables length to be 0, but got {len(variable_codebook_fixture.variables)}\""],
  "test_when_load_from_file_is_true_then_variables_are_loaded_from_file": ["assert len(variable_codebook_fixture.variables) > 0", "f\"Expected variables length to be > 0, but got {len(variable_codebook_fixture.variables)}\""],
  "test_when_run_is_called_then_log_message_indicates_operation_start": ["assert any('Starting variable codebook operation' in str(record.message) for record in caplog.records)", "f\"Expected 'Starting variable codebook operation' in logs, but got {[str(r.message) for r in caplog.records]}\""],
  "test_when_tax_assumptions_exist_then_contains_taxes_paid_period": ["assert hasattr(assumptions.taxes, 'taxes_paid_period')", "f\"Expected assumptions.taxes to have 'taxes_paid_period' attribute, but attributes are {dir(assumptions.taxes)}\""],
  "test_when_tree_nodes_are_examined_then_each_node_has_prompt_attribute": ["assert all(hasattr(node, 'prompt') for node in decision_tree.nodes)", "f\"Expected all nodes to have 'prompt' attribute, but some nodes missing it: {[node for node in decision_tree.nodes if not hasattr(node, 'prompt')]}\""],
  "test_when_tree_nodes_are_examined_then_prompts_are_strings": ["assert all(isinstance(node.prompt, str) for node in decision_tree.nodes)", "f\"Expected all prompts to be strings, but got {[type(node.prompt) for node in decision_tree.nodes]}\""],
  "test_when_update_variable_is_executed_then_success_status_is_returned": ["assert result['success'] is True", "f\"Expected result['success'] to be True, but got {result['success']}\""],
  "test_when_update_variable_is_executed_then_updated_variable_is_persisted_to_storage": ["assert storage_service.save.called", "f\"Expected storage_service.save to be called, but called={storage_service.save.called}\""],
  "test_when_update_variable_is_executed_then_variable_in_self_variables_is_updated": ["assert variable_codebook_fixture.variables['sales_tax_city'] == updated_variable", "f\"Expected variables['sales_tax_city'] to be {updated_variable}, but got {variable_codebook_fixture.variables['sales_tax_city']}\""],
  "test_when_updating_non_existent_variable_then_error_indicates_variable_not_found": ["assert 'variable not found' in result['error'].lower()", "f\"Expected 'variable not found' in error message, but got {result['error']}\""],
  "test_when_updating_non_existent_variable_then_error_is_raised_or_returned": ["assert 'error' in result", "f\"Expected 'error' key in result, but got {list(result.keys())}\""],
  "test_when_variable_has_assumptions_then_it_is_assumptions_object": ["assert isinstance(variable.assumptions, Assumptions)", "f\"Expected variable.assumptions to be Assumptions, but got {type(variable.assumptions)}\""],
  "test_when_variable_has_no_decision_tree_then_error_message_states_no_tree_found": ["assert 'No prompt decision tree found' in result['error']", "f\"Expected 'No prompt decision tree found' in error, but got {result['error']}\""],
  "test_when_variable_has_no_decision_tree_then_result_indicates_failure": ["assert result['success'] is False", "f\"Expected result['success'] to be False, but got {result['success']}\""],
  "test_when_variable_has_prompt_decision_tree_then_it_is_digraph_object": ["assert isinstance(variable.prompt_decision_tree._graph, nx.DiGraph)", "f\"Expected variable.prompt_decision_tree._graph to be nx.DiGraph, but got {type(variable.prompt_decision_tree._graph)}\""],
  "test_when_variable_is_retrieved_then_it_has_description_field": ["assert hasattr(variable, 'description')", "f\"Expected variable to have 'description' attribute, but attributes are {dir(variable)}\""],
  "test_when_variable_is_retrieved_then_it_has_item_name_field": ["assert hasattr(variable, 'item_name')", "f\"Expected variable to have 'item_name' attribute, but attributes are {dir(variable)}\""],
  "test_when_variable_is_retrieved_then_it_has_label_field": ["assert hasattr(variable, 'label')", "f\"Expected variable to have 'label' attribute, but attributes are {dir(variable)}\""],
  "test_when_variable_is_retrieved_then_it_has_units_field": ["assert hasattr(variable, 'units')", "f\"Expected variable to have 'units' attribute, but attributes are {dir(variable)}\""],
  "test_when_variable_is_retrieved_then_it_may_have_assumptions_field": ["assert hasattr(variable, 'assumptions')", "f\"Expected variable to have 'assumptions' attribute, but attributes are {dir(variable)}\""],
  "test_when_variable_is_retrieved_then_it_may_have_prompt_decision_tree_field": ["assert hasattr(variable, 'prompt_decision_tree')", "f\"Expected variable to have 'prompt_decision_tree' attribute, but attributes are {dir(variable)}\""],
  "test_when_variable_is_serialized_then_decision_tree_is_serialized_to_dict": ["assert isinstance(serialized_dict['prompt_decision_tree'], dict)", "f\"Expected serialized_dict['prompt_decision_tree'] to be dict, but got {type(serialized_dict['prompt_decision_tree'])}\""],
  "test_when_variable_not_found_then_warning_is_logged": ["assert any('Variable not found: missing_var' in str(record.message) for record in caplog.records)", "f\"Expected 'Variable not found: missing_var' in logs, but got {[str(r.message) for r in caplog.records]}\""],
  "test_when_variables_are_loaded_then_self_variables_contains_loaded_variables": ["assert len(variable_codebook_fixture.variables) > 0", "f\"Expected variables length to be > 0, but got {len(variable_codebook_fixture.variables)}\""]
}